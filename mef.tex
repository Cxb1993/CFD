\typeout{ ====================================================================}
\typeout{ this is file mef.tex, created at 21-Mat-2016                        }
\typeout{ maintained by Gustavo Rabello dos Anjos                             }
\typeout{ e-mail: gustavo.rabello@gmail.com                                   }
\typeout{ ====================================================================}


\section{MÉTODO DE ELEMENTOS FINITOS}

O objetivo desta seção é resolver o problema anteriormente apresentado
utilizando o método de elementos finitos (MEF). Para uma introdução
detalhada ao MEF, sugere-se ...

\subsection{Laminar permanente}

Para o problema permanete, a derivada temporal é desprezada, levando-se
em conta apenas a variação das variáveis no espaço. O problema do 
escoamento unidimensional em um canal pode ser então escrito em sua
forma forte por:

\begin{align}
	\frac{\partial}{\partial y} \left(\nu \frac{\partial u}
	{\partial y}\right)
	=&
	\frac{1}{\rho} \frac{\partial p}{\partial x}
	\qquad
	\text{em}
	\qquad
	\Omega=[0,1]
	\\
	u =& u_1 \qquad \text{em} \qquad \Gamma_1
	\\
	u =& u_2 \qquad \text{em} \qquad \Gamma_2
\label{eq:mef1}
\end{align}

O termo do lado direito da primeira equação representa a derivada
segunda da velocidade $u$, entretanto o índice $2$ não aparece no
operador pois, para este caso, a viscosidade cinemática $\nu=\mu/\rho$
deve ser considerada como função e não uma constante (no caso de $\nu$
constante, a viscosidade poderia ser retirada da derivada e, então,
veríamos a derivada segunda sendo operada em $u$). O termo do lado
direto representa a inversa da densidade multiplicada pelo gradiente de
pressão na direção $x$ que para o problema proposto é um dado do
problema como verificado nas Eqs.(\ref{eq:gradp} e \ref{eq:gradp-Re}). As
demais equações representam as condições de contorno em $\Gamma_1$ e
$\Gamma_2$, que representam os pontos extremos do domínio
$\Omega=[0,1]$, ou seja $\Gamma_1 = 0$ e $\Gamma_2 = 1$ \footnote{A
utilização das letras $\Omega$ e $\Gamma$ para representação simbólica
do domínio do problema é prática recorrente em problemas matemáticos.
$\Omega$ representa espaço $R^n$, então $\Gamma$ consequentemente
representa o espaço $R^{n-1}$. Exemplo: Se $\Omega$ representa uma
esfera no espaço $R^3$, $\Gamma$ representa a casca desta esfera, ou
seja, a sua superfície limitante, então descrita no espaço $R^2$.}.

No Método de Elementos Finitos, a solução é construída sobre sua forma
fraca. Por sua vez, esta é encontrada através da ponderação de uma
função peso $w$ na forma forte do problema, ou seja:

\begin{equation}
	\int_{\Omega}w \bigg[\frac{d}{dx} k \bigg( \frac{du}{dx} \bigg) -
	\frac{1}{\rho} \frac{\partial p}{\partial x}
	\bigg] \, d \Omega
	= 0 \longrightarrow
	\int_{\Omega} w \bigg[ \frac{dw}{dx} k \frac{du}{dx} \bigg] \, d\Omega
	= 
	\int_{\Omega} w \bigg[ \frac{1}{\rho} 
	\frac{\partial p}{\partial x} \bigg] \, d\Omega 
	\label{eq:mef2}
\end{equation}

É comum integrarmos por partes as derivadas de mais alta ordem,
separando-a em dois termos distintos: um avaliado no interior do domínio
e outro avaliado no contorno. Com isso, o termo de derivada segunda toma
a forma:

\begin{equation}
	\int_{\Omega} w \bigg[\frac{d}{dx} k \bigg( \frac{du}{dx} 
	\bigg) \bigg] \, d \Omega
	=
	- \bigg( w k \frac{du}{dx} \bigg) \bigg|_{\Omega} 
	+ 
	\int_{\Omega} \frac{dw}{dx} \bigg( k \frac{du}{dx} \bigg) \, 
    d \Omega
	\label{eq:mef3}
\end{equation}

Com isso, a equação final depois da integração por partes e substituindo
o domínio $\Omega$ pelo seu intervalo geométrico, obtem-se:

\begin{equation}
	- \bigg( w k \frac{du}{dx} \bigg) \bigg|_{0}^{1} 
	+ 
	\int_{0}^{1} \frac{dw}{dx} \bigg( k \frac{du}{dx} \bigg)  \, dx
	=
	\int_{0}^{1} w \bigg[ \frac{1}{\rho} 
	\frac{\partial p}{\partial x} \bigg] \, dx
	\label{eq:mef4}
\end{equation}

Note que até este momento não houve quaisquer aproximações das funções e
o problema ainda não foi discretizado. O próximo passo para a solução da
equação diferencial é minimizar o resíduo que é obtido quando se
substitui a função desconhecida $u(x)$  e o peso $w(x)$ por soluções
aproximadas do tipo $\hat{u}(x)$ e $\hat{w}(x)$ respectivamente, na
forma fraca da equação. Estas soluções aproximadas
são definidas através de uma combinação linear de funções do tipo:

\begin{equation}
	\hat{u} 
	=
	\sum\limits_{i=1}^v N_i(x) u_i 
	\label{eq:mef5}
\end{equation}

\begin{equation}
	\hat{w} 
	=
	\sum\limits_{j=1}^v N_j(x) w_j 
	\label{eq:mef6}
\end{equation}

Note que o limite superior do somatório $v$ representa o número total de
nós da malha computacional\footnote{Objeto geométrico que define o
número de repartições discretas do domínio em elementos e pontos e como
eles são conectados entre si.} (a ser definido posteriormente).
Substituindo as funções de aproximação na formulação fraca apresentada
pela Eq.(\ref{eq:mef4}) obtemos:

\begin{equation}
	- N_j(x)w_j k \frac{d N_i(x) u_i}{dx} \bigg|_{0}^{1}
	+
	\int_{0}^{1}  
	\sum\limits_{j=1}^v
	\frac{dN_j(x) w_j}{dx} 
	k
	\sum\limits_{i=1}^v 
	\frac{d N_i(x) u_i}{dx} 
	\, dx
	=
	\int_{0}^{1}  
	\sum\limits_{j=1}^v
	N_j(x) w_j
	\bigg[ \frac{1}{\rho} \frac{\partial p}{\partial x} \bigg]
	\, dx
	\label{eq:mef7}
\end{equation}

Note que $w_j$ está presente em todos os termos da equação e pode ser
eliminado, uma vez que $w_j$ são coeficientes constantes, apesar de
desconhecidos. Rescrevendo a equação e passando o termo avaliado no
contorno para o lado direito, obtemos:

\begin{equation}
	\int_{0}^{1}  
	\sum\limits_{j=1}^v
	\frac{dN_j(x)}{dx} 
	k
	\sum\limits_{i=1}^v 
	\frac{d N_i(x) u_i}{dx} 
	\, dx
	=
	\int_{0}^{1}  
	\sum\limits_{j=1}^v
	N_j(x) 
	\bigg[ \frac{1}{\rho} \frac{\partial p}{\partial x} \bigg]
	\, dx
	+ 
	N_j(x)w_j k \frac{d N_i(x) u_i}{dx} \bigg|_{0}^{1}
	\label{eq:mef8}
\end{equation}

Manupulando-se os sinais de somatório da Eq.~(\ref{eq:mef8}) e separando
os termos que estão multiplicados por $u_i$ no lado esquerdo e os demais
termos no lado direito, chegamos à seguinte forma:

\begin{equation}
	\sum\limits_{j=1}^v
	\sum\limits_{i=1}^v 
	\bigg(
	\int_{0}^{1}  
	\frac{dN_j(x)}{dx} 
	k
	\frac{d N_i(x) u_i}{dx} 
	\, dx
	\bigg)
	u_i
    =
	\sum\limits_{j=1}^v
	\int_{0}^{1}  
	N_j(x) 
	\bigg[ \frac{1}{\rho} \frac{\partial p}{\partial x} \bigg]
	\, dx
	+
	N_j(1) \frac{d N_i(1) u_i}{dx} 
	- 
	N_j(0) \frac{d N_i(0) u_i}{dx}
	\label{eq:mef9}
\end{equation}

Note que os termos de contorno são levados para o lado direito apesar de
$u_i$ estar presente, isso se deve ao fato de $u_i$ no contorno ser
prescrito através de condições de contorno. A equação apresentada pode
ser escrita em forma tensiorial através de um sistema de equações
lineares. Considere então que: 

\begin{align}
	\sum\limits_{j=1}^v
	\sum\limits_{i=1}^v 
	\bigg(
	\int_{0}^{1}  
	\frac{dN_j(x)}{dx} 
	k
	\frac{d N_i(x) u_i}{dx} 
	\, dx
	\bigg)
	&\longrightarrow
	\mathbf{K_{ij}}
	\\
	u_i
	&\longrightarrow
	\mathbf{u_{i}}
	\\
	\sum\limits_{j=1}^v
	\int_{0}^{1}  
	N_j(x) 
	\bigg[ \frac{1}{\rho} \frac{\partial p}{\partial x} \bigg]
	\, dx
	&\longrightarrow
	\mathbf{f_{j}}
\end{align}


\noindent onde $u$ tem como componentes os valores nodais $u_n$, a
matriz $\mathbf{K}$ e o vetor $\mathbf{f}$ representados por uma
montagem conhecida com \emph{Assembling}:

\begin{equation}
	\mathbf{K_{ij}} u_i = \mathbf{f_j} 
\end{equation}

Matriz de triangulação (vizinhos):
\input{codes/ien}
\vspace{1cm}

Código para geração da Matriz $K$.
\input{codes/assembling1}



\typeout{ ****************** End of file mef.tex ****************** }

